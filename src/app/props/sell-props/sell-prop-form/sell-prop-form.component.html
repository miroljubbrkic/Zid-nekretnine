<mat-card class="sell-prop-form-card">
  <mat-progress-bar *ngIf="isLoading" mode="indeterminate" color="warn"></mat-progress-bar>

  <form [formGroup]="form" (submit)="onSaveProp()" *ngIf="!isLoading">
    <!-- Naslov -->
    <mat-form-field appearance="outline">
      <mat-label>Naslov</mat-label>
      <input matInput formControlName="naslov" placeholder="Naslov oglasa">
    </mat-form-field>

    <!-- Tip -->
    <mat-form-field appearance="outline">
      <mat-label>Tip</mat-label>
      <mat-select formControlName="tip">
        <mat-option *ngFor="let tip of tipovi" [value]="tip.value">
          {{ tip.name }}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <!-- Struktura -->
    <mat-form-field appearance="outline">
      <mat-label>Struktura</mat-label>
      <mat-select formControlName="struktura">
        <mat-option *ngFor="let struktura of strukture" [value]="struktura.value">
          {{ struktura.name }}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <!-- Grad -->
    <mat-form-field appearance="outline">
      <mat-label>Grad</mat-label>
      <input matInput formControlName="grad" placeholder="Grad">
    </mat-form-field>

    <!-- Naselje -->
    <mat-form-field appearance="outline">
      <mat-label>Naselje</mat-label>
      <input matInput formControlName="naselje" placeholder="Naselje">
    </mat-form-field>

    <!-- Adresa -->
    <mat-form-field appearance="outline">
      <mat-label>Adresa</mat-label>
      <input matInput formControlName="adresa" placeholder="Adresa">
    </mat-form-field>

    <!-- Površina -->
    <mat-form-field appearance="outline">
      <mat-label>Površina (m²)</mat-label>
      <input matInput type="number" formControlName="povrsina" placeholder="Površina">
    </mat-form-field>

    <!-- Cena -->
    <mat-form-field appearance="outline">
      <mat-label>Cena (€)</mat-label>
      <input matInput type="number" formControlName="cena" placeholder="Cena">
    </mat-form-field>

    <!-- Spratovi -->
    <mat-form-field appearance="outline">
      <mat-label>Spratovi</mat-label>
      <input matInput type="number" formControlName="spratovi" placeholder="Ukupan broj spratova">
    </mat-form-field>

    <!-- Sprat -->
    <mat-form-field appearance="outline">
      <mat-label>Sprat</mat-label>
      <input matInput type="number" formControlName="sprat" placeholder="Sprat">
    </mat-form-field>

    <!-- Lift -->
    <mat-form-field appearance="outline">
      <mat-label>Lift</mat-label>
      <mat-select formControlName="lift">
        <mat-option [value]="true">Da</mat-option>
        <mat-option [value]="false">Ne</mat-option>
      </mat-select>
    </mat-form-field>

    <!-- Grejanje -->
    <mat-form-field appearance="outline">
      <mat-label>Grejanje</mat-label>
      <mat-select formControlName="grejanje">
        <mat-option *ngFor="let option of grejanje" [value]="option.value">
          {{ option.name }}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <!-- Namestenost -->
    <mat-form-field appearance="outline">
      <mat-label>Namestenost</mat-label>
      <mat-select formControlName="namestenost">
        <mat-option [value]="true">Namešten</mat-option>
        <mat-option [value]="false">Nenamešten</mat-option>
      </mat-select>
    </mat-form-field>

    <!-- Uknjiženost -->
    <mat-form-field appearance="outline">
      <mat-label>Uknjiženost</mat-label>
      <mat-select formControlName="uknjizenost">
        <mat-option [value]="true">Uknjižen</mat-option>
        <mat-option [value]="false">Neuknjižen</mat-option>
      </mat-select>
    </mat-form-field>

    <!-- Image Picker Button -->
    <div class="image-picker">
      <button mat-stroked-button type="button" (click)="imgPicker.click()">Izaberite slike</button>
      <input type="file" #imgPicker (change)="onImagePicked($event)" multiple>
    </div>

    <!-- Image Previews -->
    <div *ngIf="imgPreviews && imgPreviews.length > 0" class="image-previews">
      <mat-grid-list cols="3" rowHeight="200px" gutterSize="16px">
        <mat-grid-tile *ngFor="let img of imgPreviews; let i = index">
          <mat-card class="image-card">
            <button mat-icon-button color="warn" class="delete-button" (click)="onDeleteImage(i)">
              <mat-icon>delete</mat-icon>
            </button>
            <img mat-card-image [src]="img" [alt]="form.value.povrsina + ' ' + form.value.opis">
          </mat-card>
        </mat-grid-tile>
      </mat-grid-list>
    </div>

    <!-- Opis -->
    <mat-form-field appearance="outline">
      <mat-label>Opis</mat-label>
      <textarea matInput rows="4" formControlName="opis" placeholder="Opis"></textarea>
    </mat-form-field>

    <div class="button-container">
      <!-- Cancel Button -->
      <button mat-raised-button color="warn" type="button" (click)="onCancel()" class="cancel-button">Otkaži</button>
      
      <!-- Save Button -->
      <button mat-raised-button color="primary" type="submit" class="save-button">Sačuvaj</button>
    </div>
  </form>
</mat-card>
